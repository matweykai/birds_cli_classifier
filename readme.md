# Что реализовано:

- Обучение модели для классификации птиц
- Предсказание класса птицы

## Структура проекта

* birds_classification - оригинальный набор данных с птицами
* birds_classification_fixed - набор данных с исправленной разметкой
* notebooks - содержит Jupyter ноутбуки с кодом, написанном при исследовании задачи
* code - содержит исходный код CLI приложения
* ResearchReport.pdf содержит отчёт об исследовании в формате PDF

## **Установка**
```
git clone https://github.com/matweykai/birds_cli_classifier.git
```
Далее необходимо собрать Docker образ из Dockerfile. Для этого необходимо находиться в корне проекта и запустить команду
```
sudo docker build -t birds_model_image .
```
После сборки образа необходимо создать недостающие директории, чтобы дерево проекта получилось таким:

```
.
├── birds_classification
├── birds_classification_fixed
├── code
├── inference
├── model
└── notebooks 
```

## **Запуск**
Запускаем контейнер с помощью команды (Нужно находиться в корне проекта или явно прописывать абсолютные пути для монтирования директорий)
```
sudo docker run \
--mount type=bind,source="$(pwd)"/model,target=/model/ \
--mount type=bind,source="$(pwd)"/inference,target=/inference/ \
--shm-size=6gb \
--cpus="6." \
--gpus all \
birds_model_image {command}
```
В поле {command} нужно передать команду для приложения. Их варианты:

  1) -t или --train
    
*запускает обучение на данных, которые лежат в birds_classification_fixed (**Эти данные записываются туда при сборке докер образа и не могут быть добавлены без пересборки контейнера**)*

  2) -p *путь до картинки*

*забирает картинку по данному пути(**путь указывается относительно папки inference и файл должен находиться внутри неё или её поддиректорий, тк она монтируется в докер контейнер**)*

### **Первый запуск команд**

При первом запуске команд будут загружены 2 файла: 
* base_model.bin - отвечает за базовую модель трансформера, которая дообучается под данную задачу
* crop_model.bin - вспомогательная модель, которая участвует в предобработке данных

### Доп ссылки:
```
https://www.kaggle.com/code/matweykai/birdsclassification - JupyterNotebook на Kaggle, где лежат исходники исследования и их можно запустить на GPU
```